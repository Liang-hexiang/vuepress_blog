var f=Object.defineProperty;var T=(s,e,t)=>e in s?f(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var r=(s,e,t)=>(T(s,typeof e!="symbol"?e+"":e,t),t);import{H as d,y as k,W as h,z as P,X as v,w as c,Y as l,Z as p,D as E,_ as I,$ as o}from"./register-3334cf80.js";import{H as w}from"./provider-bc0469af.js";import"./app-0bcf9f32.js";class A{constructor(e,t){this.aa=e,this.ph=t,e.textTracks.onaddtrack=this.fa.bind(this),d(this.Hh.bind(this))}fa(e){const t=e.track;if(!t||H(this.aa,t))return;const i=new k({id:t.id,kind:t.kind,label:t.label,language:t.language,type:"vtt"});i[h]={track:t},i[P]=2,i[v]=!0;let a=0;const u=g=>{if(t.cues)for(let n=a;n<t.cues.length;n++)i.addCue(t.cues[n],g),a++};u(e),t.oncuechange=u,this.ph.textTracks.add(i,e),i.setMode(t.mode,e)}Hh(){var e;this.aa.textTracks.onaddtrack=null;for(const t of this.ph.textTracks){const i=(e=t[h])==null?void 0:e.track;i!=null&&i.oncuechange&&(i.oncuechange=null)}}}function H(s,e){return Array.from(s.children).find(t=>t.track===e)}class m{constructor(e,t){r(this,"Hc",(e,t)=>{this.k.delegate.R("picture-in-picture-change",{detail:e,trigger:t})});this.aa=e,this.k=t,c(this.aa,"enterpictureinpicture",this.ri.bind(this)),c(this.aa,"leavepictureinpicture",this.si.bind(this))}get active(){return document.pictureInPictureElement===this.aa}get supported(){return l(this.aa)}async enter(){return this.aa.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}ri(e){this.Hc(!0,e)}si(e){this.Hc(!1,e)}}class x{constructor(e,t){r(this,"Ga","inline");this.aa=e,this.k=t,c(this.aa,"webkitpresentationmodechanged",this.wi.bind(this))}get vi(){return p(this.aa)}async ui(e){this.Ga!==e&&this.aa.webkitSetPresentationMode(e)}wi(){var t;const e=this.Ga;this.Ga=this.aa.webkitPresentationMode,(t=this.k.player)==null||t.dispatchEvent(new E("video-presentation-change",{detail:this.Ga,trigger:event})),["fullscreen","picture-in-picture"].forEach(i=>{(this.Ga===i||e===i)&&this.k.delegate.R(`${i}-change`,{detail:this.Ga===i,trigger:event})})}}class y{constructor(e){this.ti=e}get active(){return this.ti.Ga==="fullscreen"}get supported(){return this.ti.vi}async enter(){this.ti.ui("fullscreen")}async exit(){this.ti.ui("inline")}}class R{constructor(e){this.ti=e}get active(){return this.ti.Ga==="picture-in-picture"}get supported(){return this.ti.vi}async enter(){this.ti.ui("picture-in-picture")}async exit(){this.ti.ui("inline")}}class C extends w{constructor(t,i){super(t);r(this,"$$PROVIDER_TYPE","VIDEO");r(this,"fullscreen");r(this,"pictureInPicture");if(p(t)){const a=new x(t,i);this.fullscreen=new y(a),this.pictureInPicture=new R(a)}else l(t)&&(this.pictureInPicture=new m(t,i))}get type(){return"video"}setup(t){super.setup(t),I(this.video)&&new A(this.video,t),t.textRenderers[o](this.video),d(()=>{t.textRenderers[o](null)}),this.type==="video"&&t.delegate.R("provider-setup",{detail:this})}get video(){return this.k}}export{C as VideoProvider};
